# Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              THE GREAT BULLS SYSTEM                                  â”‚
â”‚                         Stock Market Analysis & Trading Platform                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   USER INTERFACE                                      â”‚
â”‚                                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                         Flutter Web Application                               â”‚  â”‚
â”‚  â”‚                    (http://localhost:PORT)                                    â”‚  â”‚
â”‚  â”‚                                                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚  â”‚   Landing    â”‚    â”‚   Trading    â”‚    â”‚  AI Insights â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚     Page     â”‚â”€â”€â”€â–¶â”‚  Dashboard   â”‚    â”‚     Page     â”‚                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                              â”‚                                                â”‚  â”‚
â”‚  â”‚                              â”‚                                                â”‚  â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚  â”‚
â”‚  â”‚                    â”‚  Live Charts Tab   â”‚                                    â”‚  â”‚
â”‚  â”‚                    â”‚  (Kite WebSocket)  â”‚                                    â”‚  â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚  â”‚
â”‚  â”‚                              â”‚                                                â”‚  â”‚
â”‚  â”‚                              â”‚                                                â”‚  â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚  â”‚
â”‚  â”‚              â”‚                               â”‚                                â”‚  â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚  â”‚
â”‚  â”‚       â”‚  Stock List   â”‚             â”‚  Candlestick     â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚  (Sidebar)    â”‚             â”‚  Chart Widget    â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚               â”‚             â”‚                  â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚ â€¢ NIFTY 50    â”‚             â”‚ â€¢ 1m, 5m, 15m   â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚ â€¢ NIFTY BANK  â”‚             â”‚ â€¢ Volume overlay â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚ â€¢ FIN SERVICE â”‚             â”‚ â€¢ OHLC data     â”‚                    â”‚  â”‚
â”‚  â”‚       â”‚ â€¢ MIDCAP      â”‚             â”‚ â€¢ Live updates  â”‚                    â”‚  â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ ğŸ“Š Load History â”‚â—€â”€â”€â”                â”‚  â”‚
â”‚  â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚              DATA SOURCES             â”‚                â”‚
                          â”‚                                       â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                â”‚
â”‚    LIVE DATA STREAM     â”‚                       â”‚               â”‚                â”‚
â”‚                         â”‚                       â”‚               â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚               â”‚                â”‚
â”‚  â”‚   Kite WebSocket Server         â”‚           â”‚               â”‚                â”‚
â”‚  â”‚  wss://ws.kite.trade            â”‚           â”‚               â”‚                â”‚
â”‚  â”‚                                  â”‚           â”‚               â”‚                â”‚
â”‚  â”‚  â€¢ Binary tick data (ArrayBuffer)â”‚          â”‚               â”‚                â”‚
â”‚  â”‚  â€¢ Full mode with OHLC           â”‚          â”‚               â”‚                â”‚
â”‚  â”‚  â€¢ Real-time price updates       â”‚          â”‚               â”‚                â”‚
â”‚  â”‚  â€¢ Volume & order flow           â”‚          â”‚               â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚               â”‚                â”‚
â”‚                                                 â”‚               â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                â”‚
                                                                  â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      AWS CLOUD INFRASTRUCTURE                  â”‚                â”‚
â”‚                          (Region: us-east-1)                   â”‚                â”‚
â”‚                                                                â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      API Gateway (HTTP API)                                â”‚ â”‚
â”‚  â”‚            https://erkg1luks7.execute-api.us-east-1.amazonaws.com         â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Routes:                                                                   â”‚ â”‚
â”‚  â”‚  â€¢ GET /data?action=historical&instrument=256265&limit=500                â”‚ â”‚
â”‚  â”‚  â€¢ GET /data?action=recent&limit=100                                      â”‚ â”‚
â”‚  â”‚  â€¢ GET /data?action=stats                                                 â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  CORS: Enabled (AllowOrigins: *, AllowMethods: GET/POST/OPTIONS)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                                             â”‚
â”‚                                   â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    AWS Lambda Function                                     â”‚ â”‚
â”‚  â”‚              opensearch-query-function (Node.js 18.x)                      â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  â€¢ Query OpenSearch with AWS SigV4 auth                                   â”‚ â”‚
â”‚  â”‚  â€¢ Filter by instrument token                                             â”‚ â”‚
â”‚  â”‚  â€¢ Return formatted JSON responses                                        â”‚ â”‚
â”‚  â”‚  â€¢ Handle errors gracefully                                               â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Memory: 512 MB  |  Timeout: 30s  |  Runtime: nodejs18.x                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                                             â”‚
â”‚                                   â”‚ AWS SigV4                                   â”‚
â”‚                                   â”‚ Authentication                              â”‚
â”‚                                   â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      OpenSearch Domain                                     â”‚ â”‚
â”‚  â”‚      search-kite-stock-data-4phbzwci5cfo6jla7vs7yrjkcu.us-east-1.es...   â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Index: kite-stock-data                                                   â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Schema:                                                                  â”‚ â”‚
â”‚  â”‚  â€¢ instrument_token (integer)                                             â”‚ â”‚
â”‚  â”‚  â€¢ timestamp (date)                                                       â”‚ â”‚
â”‚  â”‚  â€¢ interval (keyword): 1m, 5m, 15m                                       â”‚ â”‚
â”‚  â”‚  â€¢ open, high, low, close (float)                                        â”‚ â”‚
â”‚  â”‚  â€¢ volume (long)                                                          â”‚ â”‚
â”‚  â”‚  â€¢ embedding (knn_vector, dimension: 384)                                â”‚ â”‚
â”‚  â”‚  â€¢ text (text): Searchable description                                   â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Storage: Vector + Time-series data                                       â”‚ â”‚
â”‚  â”‚  Version: OpenSearch 2.5                                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                                             â”‚
â”‚                                   â”‚ Continuous                                  â”‚
â”‚                                   â”‚ Data Ingestion                              â”‚
â”‚                                   â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ECS Fargate Service                                 â”‚ â”‚
â”‚  â”‚                      kite-collector-service                                â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Task Definition: kite-collector-task:9                                   â”‚ â”‚
â”‚  â”‚  Container: kite-collector (Python 3.10)                                  â”‚ â”‚
â”‚  â”‚  Resources: 1 vCPU, 2 GB Memory                                           â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Script: scripts/kite_integration.py                                      â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Functions:                                                               â”‚ â”‚
â”‚  â”‚  â€¢ Connect to Kite WebSocket                                              â”‚ â”‚
â”‚  â”‚  â€¢ Process live ticks                                                     â”‚ â”‚
â”‚  â”‚  â€¢ Create embeddings (sentence-transformers)                              â”‚ â”‚
â”‚  â”‚  â€¢ Store in OpenSearch                                                    â”‚ â”‚
â”‚  â”‚  â€¢ Backup to S3 as parquet files                                         â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  Status: RUNNING (Desired: 1, Running: 1)                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                                             â”‚
â”‚                                   â”‚ Backup                                      â”‚
â”‚                                   â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          S3 Bucket                                         â”‚ â”‚
â”‚  â”‚                  kite-data-backup-955223516342                             â”‚ â”‚
â”‚  â”‚                                                                            â”‚ â”‚
â”‚  â”‚  â€¢ Parquet files with market data                                         â”‚ â”‚
â”‚  â”‚  â€¢ Organized by date and instrument                                       â”‚ â”‚
â”‚  â”‚  â€¢ Lifecycle policy: Glacier after 30 days                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                DATA FLOW DIAGRAM                                     â”‚
â”‚                                                                                      â”‚
â”‚  1. COLLECTION                                                                       â”‚
â”‚     Kite API â”€â”€â–¶ ECS Fargate â”€â”€â–¶ OpenSearch (index) â”€â”€â–¶ S3 (backup)               â”‚
â”‚                                                                                      â”‚
â”‚  2. QUERY                                                                            â”‚
â”‚     Flutter App â”€â”€â–¶ API Gateway â”€â”€â–¶ Lambda â”€â”€â–¶ OpenSearch â”€â”€â–¶ Lambda â”€â”€â–¶ Flutter  â”‚
â”‚                                                                                      â”‚
â”‚  3. LIVE UPDATES                                                                     â”‚
â”‚     Kite WebSocket â”€â”€â–¶ Browser â”€â”€â–¶ Chart Widget (real-time rendering)             â”‚
â”‚                                                                                      â”‚
â”‚  4. MERGED VIEW                                                                      â”‚
â”‚     Historical Data (OpenSearch) + Live Data (WebSocket) = Complete Chart           â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  KEY METRICS                                         â”‚
â”‚                                                                                      â”‚
â”‚  â€¢ Data Latency: <500ms (live ticks)                                               â”‚
â”‚  â€¢ Chart Update Rate: 60 FPS                                                        â”‚
â”‚  â€¢ Historical Data: Up to 500 candles per request                                  â”‚
â”‚  â€¢ Supported Intervals: 1m, 5m, 15m                                                â”‚
â”‚  â€¢ Instruments: 4 NIFTY indices (expandable to all NSE stocks)                     â”‚
â”‚  â€¢ Storage: Vector embeddings (384 dimensions) for semantic search                 â”‚
â”‚  â€¢ Cost: Pay-as-you-go (Lambda, OpenSearch, S3, ECS)                              â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Details

### 1. Flutter Web App
- **Framework**: Flutter 3.x
- **Platform**: Web (supports desktop browsers)
- **State Management**: StatefulWidget with local state
- **Storage**: IndexedDB for offline caching
- **Charts**: Lightweight Charts library (TradingView)

### 2. API Gateway
- **Type**: HTTP API (cheaper than REST API)
- **CORS**: Fully configured for web access
- **Authentication**: None (public endpoint, but Lambda uses SigV4 for OpenSearch)
- **Throttling**: Default AWS limits

### 3. Lambda Function
- **Language**: JavaScript (Node.js 18.x)
- **Package Size**: ~17.5 MB (includes OpenSearch client + AWS SDK)
- **Cold Start**: ~1-2 seconds first invocation
- **Warm Execution**: <200ms typical
- **Concurrent Executions**: 10 (default, can be increased)

### 4. OpenSearch
- **Engine**: OpenSearch 2.5 (Apache 2.0 fork of Elasticsearch)
- **Instance**: t3.small.search (1 instance)
- **Storage**: EBS (SSD)
- **Features**: Full-text search, vector search (kNN), time-series queries
- **Access**: VPC endpoint or public with IAM authentication

### 5. ECS Fargate
- **Orchestration**: Serverless container management
- **Task**: Python 3.10 container running data collector
- **Networking**: Public subnet with NAT gateway
- **Auto-scaling**: Can be configured (currently 1 task)
- **Health Check**: ECS built-in health monitoring

### 6. S3 Bucket
- **Purpose**: Backup and long-term storage
- **Format**: Apache Parquet (columnar format)
- **Lifecycle**: Glacier transition after 30 days
- **Versioning**: Disabled (not needed for time-series data)

## Security

- **API Gateway**: No authentication (public read access)
- **Lambda â†’ OpenSearch**: AWS SigV4 (IAM role-based)
- **ECS â†’ OpenSearch**: IAM role with minimal permissions
- **ECS â†’ S3**: IAM role with PutObject only
- **Secrets**: Stored in AWS Secrets Manager (Kite API credentials)

## Cost Estimate (Monthly)

| Service | Usage | Estimated Cost |
|---------|-------|----------------|
| API Gateway | 1M requests | $1.00 |
| Lambda | 1M invocations @ 512MB, 1s avg | $0.83 |
| OpenSearch | t3.small.search, 24/7 | $33.00 |
| ECS Fargate | 1 task, 1 vCPU, 2GB, 24/7 | $29.65 |
| S3 | 10 GB storage, 1K writes | $0.26 |
| **Total** | | **~$65/month** |

*Estimate based on low-moderate traffic. Actual costs may vary.*

## Scalability

- **Horizontal**: Add more ECS tasks for redundancy
- **Vertical**: Upgrade OpenSearch instance type for more data
- **Geographic**: Deploy in multiple regions for global access
- **Instruments**: Current: 4 indices, Can support: 1000+ stocks
- **Data Retention**: Configure OpenSearch index lifecycle policies
